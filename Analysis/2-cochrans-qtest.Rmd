---
title: "Cochran's Q Test in R"
author: "<a href='https://www.yourwebsite.com'><img src='../yuvijen-logo.png' style='height:40px; vertical-align:middle; margin-right:8px;'></a>"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
options(repos = c(CRAN = "[https://cran.rstudio.com/](https://cran.rstudio.com/)"))
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```

First, make sure that you have the necessary package installed for conducting the Cochran’s Q test:

### Cochran’s Q test:

```{r}
install.packages("DescTools")

library(DescTools)
# Data for the Cochran's Q Test
# Rows are testers, columns are software versions
data <- matrix(c(
  1, 0, 0,  # Tester 1
  1, 0, 0,  # Tester 2
  1, 0, 0,  # Tester 3
  1, 0, 0,  # Tester 4
  1, 0, 0,  # Tester 5
  1, 1, 0,  # Tester 6
  1, 1, 0,  # Tester 7
  1, 1, 1,  # Tester 8
  1, 1, 1,  # Tester 9
  0, 1, 1   # Tester 10
), byrow = TRUE, nrow = 10)

colnames(data) <- c("Version1", "Version2", "Version3")

# Perform Cochran's Q Test
result <- CochranQTest(data)

# Output the result
print(result)

# Interpretation
alpha <- 0.05
if (result$p.value < alpha) {
  cat("\nReject H0: There is a significant difference in reliability among versions.\n")
} else {
  cat("\nDo not reject H0: No significant difference in reliability among versions.\n")
}

```

This will calculate Cochran's Q test for the given matrix where each row represents a tester and each column represents a version of the software.


---


### Post-hoc Test for Cochran's Q-test:

```{r}
library(rcompanion)

# Significance level
alpha <- 0.05

# Check if Cochran's Q Test was significant
if(result$p.value < alpha){
  cat("Cochran's Q Test is significant: performing post-hoc pairwise McNemar tests.\n\n")
  
  # Generate all pairs of software versions
  version_pairs <- combn(ncol(data), 2, simplify = FALSE)
  
  for(pair in version_pairs){
    v1 <- pair[1]
    v2 <- pair[2]
    
    # Create 2x2 contingency table for the pair
    table_pair <- table(data[,v1], data[,v2])
    
    # McNemar test
    test <- mcnemar.test(table_pair)
    
    # Post-hoc decision
    decision <- if(test$p.value < alpha) "Significant difference" else "No significant difference"
    
    cat(colnames(data)[v1], "vs", colnames(data)[v2], ":\n")
    print(test)
    cat("Post-hoc Decision:", decision, "\n\n")
  }
  
} else {
  cat("Cochran's Q Test is not significant: post-hoc tests are not applicable.\n")
}

```


---
